---
title: "Basic"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Basic}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


# Count K-mers in FASTQ Files

We are using simulated k-mer data from the phi-X174 genome.


Getting the data and setting parameters:

```{r setup}
library(kmerize)

fq <- system.file("testdata/phix174-pe_w_err_5k_30q.fastq.gz", 
                  package = "kmerize")
k <- 9

out_file <- file.path(tempdir(), "phwei11")
out_db <- paste0(out_file, c(".kmc_pre", ".kmc_suf"))

```


Counting:

```{r}
kmer_path = kmr_count(fq, out_file, 
                  k = k, 
                  f = "q" # file input format is fastq
                  )

```

Convert to readable tabulated database:

```{r}
kp <- kmr_write_tab(kmer_path)
```
```{r}
kmers <- kmr_read_tab(kp)
head(kmers)
```


tbl <- table(kmers$count)
